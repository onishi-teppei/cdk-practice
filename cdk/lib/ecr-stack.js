"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EcrStack = void 0;
const cdk = require("aws-cdk-lib");
const ecr = require("aws-cdk-lib/aws-ecr");
const aws_cdk_lib_1 = require("aws-cdk-lib");
class EcrStack extends aws_cdk_lib_1.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        const argContext = 'environment';
        const envKey = this.node.tryGetContext(argContext);
        if (envKey == undefined)
            throw new Error(`Please specify environment with context option. ex) cdk deploy -c ${argContext}=stg`);
        const context = this.node.tryGetContext(envKey);
        if (context == undefined)
            throw new Error('Invalid environment.');
        // ECRリポジトリを作成
        this.repository = new ecr.Repository(this, `${context.AWSENV}-to2go-app-ecr-repository`, {
            repositoryName: `${context.AWSENV}-to2go-app-ecr-repository`,
            removalPolicy: cdk.RemovalPolicy.DESTROY, // スタックを削除するときにリポジトリも削除
            emptyOnDelete: true // リポジトリを削除するときにリポジトリ内のイメージも削除
        });
    }
}
exports.EcrStack = EcrStack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWNyLXN0YWNrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZWNyLXN0YWNrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLG1DQUFtQztBQUNuQywyQ0FBMkM7QUFDM0MsNkNBQThDO0FBSzlDLE1BQWEsUUFBUyxTQUFRLG1CQUFLO0lBTWpDLFlBQVksS0FBZ0IsRUFBRSxFQUFVLEVBQUUsS0FBa0I7UUFDMUQsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFFeEIsTUFBTSxVQUFVLEdBQUcsYUFBYSxDQUFDO1FBQ2pDLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ25ELElBQUksTUFBTSxJQUFJLFNBQVM7WUFDckIsTUFBTSxJQUFJLEtBQUssQ0FBQyxxRUFBcUUsVUFBVSxNQUFNLENBQUMsQ0FBQztRQUN6RyxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNoRCxJQUFJLE9BQU8sSUFBSSxTQUFTO1lBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO1FBRWxFLGNBQWM7UUFDZCxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksR0FBRyxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsR0FBRyxPQUFPLENBQUMsTUFBTSwyQkFBMkIsRUFBRTtZQUN2RixjQUFjLEVBQUUsR0FBRyxPQUFPLENBQUMsTUFBTSwyQkFBMkI7WUFDNUQsYUFBYSxFQUFFLEdBQUcsQ0FBQyxhQUFhLENBQUMsT0FBTyxFQUFFLHVCQUF1QjtZQUNqRSxhQUFhLEVBQUUsSUFBSSxDQUFDLDhCQUE4QjtTQUNuRCxDQUFDLENBQUE7SUFDSixDQUFDO0NBQ0Y7QUF2QkQsNEJBdUJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgY2RrIGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCAqIGFzIGVjciBmcm9tICdhd3MtY2RrLWxpYi9hd3MtZWNyJztcbmltcG9ydCB7U3RhY2ssIFN0YWNrUHJvcHN9IGZyb20gXCJhd3MtY2RrLWxpYlwiO1xuaW1wb3J0IHtDb25zdHJ1Y3R9IGZyb20gXCJjb25zdHJ1Y3RzXCI7XG5pbXBvcnQge1JlcG9zaXRvcnl9IGZyb20gXCJhd3MtY2RrLWxpYi9hd3MtZWNyXCI7XG5pbXBvcnQge0RvY2tlckltYWdlQXNzZXR9IGZyb20gXCJhd3MtY2RrLWxpYi9hd3MtZWNyLWFzc2V0c1wiO1xuXG5leHBvcnQgY2xhc3MgRWNyU3RhY2sgZXh0ZW5kcyBTdGFjayB7XG5cbiAgcHVibGljIHJlYWRvbmx5IHJlcG9zaXRvcnk6IFJlcG9zaXRvcnk7XG4gIHB1YmxpYyByZWFkb25seSBpbWFnZU9ubGluZTogRG9ja2VySW1hZ2VBc3NldDtcbiAgcHVibGljIHJlYWRvbmx5IGltYWdlQmF0Y2g6IERvY2tlckltYWdlQXNzZXQ7XG5cbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZywgcHJvcHM/OiBTdGFja1Byb3BzKSB7XG4gICAgc3VwZXIoc2NvcGUsIGlkLCBwcm9wcyk7XG5cbiAgICBjb25zdCBhcmdDb250ZXh0ID0gJ2Vudmlyb25tZW50JztcbiAgICBjb25zdCBlbnZLZXkgPSB0aGlzLm5vZGUudHJ5R2V0Q29udGV4dChhcmdDb250ZXh0KTtcbiAgICBpZiAoZW52S2V5ID09IHVuZGVmaW5lZClcbiAgICAgIHRocm93IG5ldyBFcnJvcihgUGxlYXNlIHNwZWNpZnkgZW52aXJvbm1lbnQgd2l0aCBjb250ZXh0IG9wdGlvbi4gZXgpIGNkayBkZXBsb3kgLWMgJHthcmdDb250ZXh0fT1zdGdgKTtcbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5ub2RlLnRyeUdldENvbnRleHQoZW52S2V5KTtcbiAgICBpZiAoY29udGV4dCA9PSB1bmRlZmluZWQpIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBlbnZpcm9ubWVudC4nKTtcblxuICAgIC8vIEVDUuODquODneOCuOODiOODquOCkuS9nOaIkFxuICAgIHRoaXMucmVwb3NpdG9yeSA9IG5ldyBlY3IuUmVwb3NpdG9yeSh0aGlzLCBgJHtjb250ZXh0LkFXU0VOVn0tdG8yZ28tYXBwLWVjci1yZXBvc2l0b3J5YCwge1xuICAgICAgcmVwb3NpdG9yeU5hbWU6IGAke2NvbnRleHQuQVdTRU5WfS10bzJnby1hcHAtZWNyLXJlcG9zaXRvcnlgLFxuICAgICAgcmVtb3ZhbFBvbGljeTogY2RrLlJlbW92YWxQb2xpY3kuREVTVFJPWSwgLy8g44K544K/44OD44Kv44KS5YmK6Zmk44GZ44KL44Go44GN44Gr44Oq44Od44K444OI44Oq44KC5YmK6ZmkXG4gICAgICBlbXB0eU9uRGVsZXRlOiB0cnVlIC8vIOODquODneOCuOODiOODquOCkuWJiumZpOOBmeOCi+OBqOOBjeOBq+ODquODneOCuOODiOODquWGheOBruOCpOODoeODvOOCuOOCguWJiumZpFxuICAgIH0pXG4gIH1cbn1cbiJdfQ==